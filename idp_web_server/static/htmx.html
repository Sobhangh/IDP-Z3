
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title></title>

  <!-- Materialize -->
  <!-- https://materializecss.github.io/materialize/ -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@materializecss/materialize@1.1.0/dist/css/materialize.min.css">
  <script src="https://cdn.jsdelivr.net/npm/@materializecss/materialize@1.1.0/dist/js/materialize.min.js"></script>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

</head>
<body>
<div id="container" class="container">
    <div class="row">
      <div class="col s12 m6 push-m3">
        <h4>Interactive Consultant</h4>
        <p class="flow-text">Choose an app:</p>
        <ul class="collection">
          <li class="collection-item"><a href="/htmx/file/open/specification.idp">Covid</a></li>
          <li class="collection-item"><a href="/htmx/file/open/polygon.idp">Polygon</a></li>
          <li class="collection-item"><a href="/htmx/file/open/simple_registratie.idp">Simple Registration</a></li>
          <li class="collection-item"><a href="/htmx/file/open/registratie.idp">Registration</a></li>
        </ul>
      </div>
    </div>
</div>

<!-- Modal Structure -->
<div id="modal1" class="modal">
  <div class="modal-content">
    <h4>Modal Header</h4>
    <p>A bunch of text</p>
  </div>
  <div class="modal-footer">
    <a href="#!" class="modal-close waves-effect waves-green btn-flat">Close</a>
  </div>
</div>

  <!-- htmx -->
  <script src="https://unpkg.com/htmx.org@1.8.0" integrity="sha384-cZuAZ+ZbwkNRnrKi05G/fjBX+azI9DNOkNYysZ0I/X5ZFgsmMiBXgDZof30F5ofc" crossorigin="anonymous"></script>

  <script>

    // hack to keep the current tab selected
    var active_tab
    htmx.on("htmx:beforeSwap", function(evt){
      target = document.querySelector('.tabs');
      if (target !== null) {
        active_tab = document.querySelector('.active')
      }
    })

    htmx.onLoad(function(target) {

      // initialize tabs in materialize, if any
      target = document.querySelector('.tabs');
      if (target !== null) {
        M.Tabs.init(target, {'swipeable': true});
        if (active_tab) {
          // select active_tab without CSS transition
          var instance = M.Tabs.getInstance(target);
          instance.options.duration = 0; instance._tabsCarousel.options.duration = 0;
          instance.select(active_tab.id.substr(1))
          setTimeout(() => {
            instance.options.duration = 300; instance._tabsCarousel.options.duration = 200
          }, 1000);
        }
      }

      // increase height of carousel for swipeable tabs
      // https://github.com/Dogfalo/materialize/issues/4159
      function tabs_height() {
        let maxHeight = 0;
        const carouselItems = document.querySelectorAll('.collapsible');
        let currentItemHeight;
        carouselItems.forEach(item => {
            currentItemHeight = getComputedStyle(item).height;
            currentItemHeight = currentItemHeight.substring(0, currentItemHeight.indexOf('px')); // just removing the 'px' at the end
            if(+currentItemHeight > +maxHeight)
                maxHeight = currentItemHeight;
        });
        tabs = document.querySelector('.tabs-content');
        if (tabs) {
          tabs.style.height = String(+maxHeight+5)+'px';
        };
      }
      tabs_height();

      // initialize collapsibles
      var elems = document.querySelectorAll('.collapsible');
      var instances = M.Collapsible.init(elems, {onOpenEnd: tabs_height, onCloseEnd: tabs_height});

      // modal buttons
      var elems = document.querySelectorAll('.modal');
      var instances = M.Modal.init(elems, {});

      // don't unfold consequences
      // (https://github.com/Dogfalo/materialize/issues/1996 not working with modal)
      elems = document.querySelectorAll(".dont-unfold").forEach(el=> {
        el.addEventListener("click", e => { // re-collapse it immediately
            setTimeout(() => {
              elems = document.querySelectorAll(".collapsible-body").forEach(el=> {
                  el.style.display="none";
                })
            }, 50 )
        })
      })

    });

    // checkboxes are like radio-buttons
    document.body.addEventListener('click', (evt) => {
      target = evt.target
      if (target.tagName.toLowerCase() === 'input'
          && target.checked == true) { // if checked, reset the others
            document.querySelectorAll('[type="checkbox"][name="'+target.name+'"]').forEach(x => x.checked=false)
            target.checked = true;
          }
    })
  </script>
</body>
</html>